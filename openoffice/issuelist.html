<!DOCTYPE html PUBLIC "-//Tigris//DTD XHTML 1.0 Transitional//EN"
"http://style.tigris.org/tigris_transitional.dtd">
<html>
           
 
 <head>
 <style type="text/css"> /* <![CDATA[ */
 @import "http://porting.openoffice.org/branding/css/tigris.css";
 @import "http://porting.openoffice.org/branding/css/inst.css";
 /* ]]> */</style>
 <link rel="stylesheet" type="text/css" href="http://porting.openoffice.org/branding/css/print.css" media="print" />
 <script src="http://porting.openoffice.org/branding/scripts/tigris.js" type="text/javascript"></script>
  
                                                  <title>
       Reference section: Issuelist
    </title>
 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
 <meta http-equiv="Content-Style-Type" content="text/css" />

 <meta name="version" content="2.6.2.3" />
 <meta name="keywords" content="OpenVMS, SourceCast, CollabNet, collaboration, companies, software, development, model, enterprise, open source, developer, network, San Francisco" />
 <meta name="description" content="SourceCast, a collaborative software development platform from CollabNet" />

 


</head>
 
 
<body onload="loginfocus()" marginwidth="0" marginheight="0" class="composite">
 
 
 <div id="banner"><table border="0" cellspacing="0" cellpadding="4" width="100%"><tr><td>
<div><a href="http://www.openoffice.org"><img src="http://www.openoffice.org/branding/images/logonew.gif" alt="Openoffice.org" id="ooologo" width="200" height="58" border="0" /></a></div>
</td>  

 <td>
  <div align="right" id="login">
    <div><small>
    <a href="http://www.openoffice.org/servlets/Join">Register</a>  |    <a href="http://www.openoffice.org/servlets/TLogin">Login</a>  |   
   </small>
  </div>
   </div>
 </td>

</tr>
</table>
</div>
 
 
 
 
 <div class="tabs" id="toptabs">
<table cellpadding="4" cellspacing="0" border="0"><tr>


  <td>   <a href="http://www.openoffice.org/servlets/DomainHome">Home</a> </td>

<td><a href="http://download.openoffice.org/index.html">Download</a></td>

<td><a href="http://support.openoffice.org/index.html">Support</a></td>

<td><a href="http://development.openoffice.org/index.html">Development</a></td>

<th>   <a href="http://www.openoffice.org/servlets/ProjectList">Projects</a> </th>

<td>   <a href="http://www.openoffice.org/servlets/StartPage">My pages</a> </td>



</tr></table></div>

  
 
 <div id="breadcrumbs">
   <a href="http://www.openoffice.org/servlets/ProjectList">Projects</a>     &nbsp;&gt;&nbsp;
     

   <strong>   <a href="http://porting.openoffice.org/"
     >porting</a>
   </strong>  </div>
 
 
 
 
<table border="0" cellspacing="0" cellpadding="4" width="100%" id="main">
<tr valign="top">
<td id="leftcol" width="20%">
 
 
 <div id="navcolumn">


  <div id="projecttools" class="toolgroup">
  <div class="label"><strong>Project tools</strong></div>
  <div class="body">
   <div>
       <a href="http://porting.openoffice.org/servlets/ProjectHome">Project home</a>    </div>
    
       
 
 <div>   <a href="http://porting.openoffice.org/servlets/ProjectMemberList">Membership</a> </div>
</div>  
 
            
 
 <div class="body">  <div>   <a href="http://porting.openoffice.org/servlets/ProjectNewsList">Announcements</a> </div>  
 
 
         
 
   
 
         
 
 <div>   <a href="http://porting.openoffice.org/servlets/ProjectMailingListList">Mailing lists</a> </div>
</div>  
 
            
 
 <div class="body"><div>   <a href="http://porting.openoffice.org/servlets/ProjectDocumentList">Documents &amp; files</a> </div>
 
 
            
 
 <div><a href="http://porting.openoffice.org/source/browse/porting/">Version control</a>


</div>
</div> 
 
               
 
 <div class="body"><div>
   <a href="http://porting.openoffice.org/servlets/ProjectIssues">Issue tracker</a> </div>
 
 
                  <div><a href=http://porting.openoffice.org/issues/buglist.cgi?issue_status=UNCONFIRMED&issue_status=NEW&issue_status=STARTED&issue_status=REOPENED&email1=guest;@openoffice.org&emailtype1=exact&emailassigned_to1=1&emailreporter1=1">My issues</a></div>
  </div>
 </div>
  




<form action="http://porting.openoffice.org/servlets/Search" method="get">
 <div id="searchbox" class="toolgroup">
  
      <div class="label"><strong>Search</strong></div>
    <div class="body">
<div>
       <select name="scope">
           <option value="projectAndSubs" selected="selected">This project</option>
               <option value="domain" >All projects</option>
    </select>
     </div>
   <div>
    <input type="hidden" name="resultsPerPage" value="40" /> 
    <input type="text" name="query" size="10" /> 
    <input type="submit" name="Button" value="Go" />
   </div>
   <div>
       <a href="http://porting.openoffice.org/servlets/Search?mode=advanced">Advanced search</a>    </div>
   <div><a href="http://support.openoffice.org/search.html">Google search</a></div>
  </div>

 </div>

</form>


<div id="helptext" class="toolgroup">
<div class="label"><strong>Help</strong></div>
<div class="body">

<div><a href="http://www.openoffice.org/sitemap.html"  onclick="return launch(this.href, 1)" 
title="Note: link may open in new window" class="helplink">Sitemap</a></div>
<div><a href="http://www.openoffice.org/faq.html"  onclick="return launch(this.href, 1)" 
title="Note: link may open in new window" class="helplink">FAQ</a></div>
<div><a href="http://porting.openoffice.org/nonav/servlets/HelpTOC" onclick="return launch(this.href, 1)" 
title="Note: link may open in new window" class="helplink">Get help?</a></div>
</div></div>


</div>
 
 
<div class="strut">&nbsp;</div>
</td>
<td>
 
<div id="bodycol">
  
<h1>
        Porting Issuelist
</h1>
<p>
        <i>
                Updated 2004-02-15, by 
                <a href="mailto:martin.borgman@oooovms.dyndns.org">
                        Martin Borgman</a>
        </i>
</p>
<!-- edit this below -->
<p>
This is a list of known areas where compatibility problems 
occur when porting from Unix to OpenVMS.
</p>
<p>
<h2>Legend</h2>
</p>
<dl>
<dt>issue#:
<dd>sequential number (1...31 from cov list, rest locally generated)
<dt>sev/prio:
<dd>severity to <strong>our</strong> port (VMS encoded..)/<strong>our</strong> priority rating (VMS encoded..)
<dd>The severity and priority are encoded from the Openoffice porting group viewpoint.
<dd>(default = I/0)
<dt>status:
<dd>VMS encoded activity from the Openoffice group viewpoint.
<dd>CUR: activly being worked on.
<dd>COM: no local activity due to lack of local resources.
<dd>LEF: waiting for something under local control (f.i. media).
<dd>CEF: waiting for something under external control (f.i. patch from VMS-enginering).
<dd>(default = LEF)
<dt>description:
<dd>Short description of the issue.
<dt>explanation,status:
<dd>Explanation of the issue and known workarrounds, fixes and viewpoints.
</dl>

	<table width="100%" cellpadding="4" cellspacing="1" bgcolor="#ffffff">
	<tr>
	        <th colspan="5" bgcolor="#00315A">
	                <div align="center">
	                        <font size="2">
	                                <b>
	                                        <font color="#ffffff">
	                                                Issuelist</font>
	                                </b>
	                        </font>
	                </div>
	        </th>
	</tr>
        <tr>
	<th bgcolor="#99ccff">
	        <div align="left">
	                <font size="-1">
	                        <b>
	                                issue# 
	                        </b>
	                </font>
	        </div>
	</th>
	<th bgcolor="#99ccff">
	        <div align="left">
	                <font size="-1">
	                        <b>
			                sev/prio
	                        </b>
	                </font>
	        </div>
	</th>
	<th bgcolor="#99ccff">
	        <div align="left">
	                <font size="-1">
	                        <b>
			                status
	                        </b>
	                </font>
	        </div>
	</th>
	<th bgcolor="#99ccff">
	        <div align="left">
	                <font size="-1">
	                        <b>
			                description
	                        </b>
	                </font>
	        </div>
	</th>
	<th bgcolor="#99ccff">
	        <div align="left">
	                <font size="-1">
	                        <b>
			                explanation, status
	                        </b>
	                </font>
	        </div>
	</th>
        </tr>
        <tr>
          <td bgcolor="#f0f0f0">
		<div align="left">
	1.
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	I/0
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	COM
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
       	stat and st_ino
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
On Unix stat.h has:
<br>
ino_t st_ino;
<br>
but on OpenVMS it has
<br>
ino_t st_ino[3];
<br>
consequently the st_ino part of the stat structure is a value
on Unix and a pointer on OpenVMS. Generally this means you have to
replace something like
<br>
if(inode == foo.st_ino)
<br>
with
<pre>
if(inode[0] == foo.st_ino[0] &&
inode[1] == foo.st_ino[1] &&
inode[2] == foo.st_ino[2[)
</pre>
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
	2.
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	I/0
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	COM
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 write() to tcp/ip socket
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
write() is supposed to send as much of a buffer as it can to the output
device and then return that value. On OpenVMS write() will fail if
it attempts to write more than 64k bytes to a socket. So even though
write() is usually used in a loop that cycles through until a buffer is
written out it won't work correctly on OpenVMS if the buffer is too big.
The <strong>workaround</strong> is to put in an #ifdef that restricts the transfer to 
< 64k bytes at one time.
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
3.
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	I/0
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	COM
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 use of select()
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
OpenVMS select() only works on sockets, it does NOT work on files.
Therefore code which uses select() to synchronize IO for both
sockets and files will not function.
<br>
The <strong>fix</strong> is reasonably complex. For an example see:
<br>
<a href="http://seqaxp.bio.caltech.edu/pub/SOFTWARE/XTERM_VMS_122_TOP.ZIP">http://seqaxp.bio.caltech.edu/pub/SOFTWARE/XTERM_VMS_122_TOP.ZIP</a>
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
4.
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	E/16
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	CUR
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 foo.tar.gz
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
Unix doesn't care what a file is, OpenVMS does. ODS2 will only accept
one ".extension" in a file name. ODS5 will accept pretty much anything
that Unix will. So, if a program from unix assumes that it can append
".whatever" and have a valid file name it will fail frequently on OpenVMS.
Currently the system disk cannot be ODS5, so even if a program does this
and works on an ODS5 user volume, it will fail if it is run on the system 
disk.
<br>
<strong>Workaround:</strong> Hunt through the code and use some other method to rename 
the files. My presonal preference is:
<br>
blah.foo + .whatever -> blah_foo.whatever
<br>
<strong>
(OO) using crtl_init.c from the GNV-tree promisses a (more) simple port
when using only ODS5 disks. At this moment (apr-2003) we plan to do a ODS5 only port.
</strong>
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
5.
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	W/4
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	COM
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 A zillion warnings on compilation
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
Bad news Bucky, most software is crap and you're looking at it. The 
OpenVMS compilers are much pickier by default than those on other
platforms and show you where the problems are. Your best bet in general
is to fix the warnings you see, and make the compiler air out all the 
code's dirty laundry. Get your code to compile cleanly with
<br>
/standard=ansi89/prefix=all/warn=enable=(level4,questcode)
<br>
and you'll save yourself a lot of trouble later on. It will also make
your code more portable.
<br>
<strong>
(OO) we know from the porting newsgroup and from direct contact that there will be
lots of 64 bit issues and typical compiler version specific workarounds in the code.
We'll try to produce clean code, but won't modify general code just for cleanlyness.
</strong>
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
6.
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	E/16
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	CUR
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 use of unix paths
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
Most Unix code thinks that it can always take a path and add
"/blah/foo.bar" to get a relative path. This will work on OpenVMS
as well so long as the initial path is in Unix format. However
if somebody entered: "USRDISK:[JOE.TEST]" then the full file
spec will be a hybrid: "USRDISK:[JOE.TEST]/blah/foo.bar"
which won't fly. Compaq C provides functions for converting
back and forth between OpenVMS and Unix file/path specs. 
In general, you want to stick with Unix file paths since compilers
on some other nonUnix platforms support them, but OpenVMS file
paths are only useful on OpenVMS.
<br>
<strong>Ultimate fix</strong>: a standard set of C routines which define a file/path
structure something like:
<pre>
char * nodename;
struct ACCESSSTRU access;
char * device;
struct PATHSTRU path;
char * name;
char * type;
char * version;
</pre>
which will hide all the delimiter information (so no more explicit
testing of []:/\. etc. in the code). And even then programmers will have
to stick to the routines which manipulate this structure. So long as all
this information is lumped into one character string inside the code
there will always be portability problems. This was a design flaw in
the C language which should have been handled back when "fopen" was first
defined.
<br>
<strong>
(OO) using crtl_init.c from the GNV-tree promisses a (more) simple port
when using only ODS5 disks. At this moment (apr-2003) we plan to do a ODS5 only port.
</strong>
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
7.
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	I/0
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	LEF
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 stream-lf and long writes
		</div>
  	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
The default file type produced by the C RTL on OpenVMS is stream-lf.
It is very similar to the text file format on Unix EXCEPT that records
can't go above 32767 bytes. Well, they can, but they get split
and basically it doesn't quite work like it does on Unix.
<br>
<strong>Workaround:</strong> If possible, use binary file types. Also complain loudly
and bitterly (and most likely, futilely) to Compaq and maybe someday
they'll fix it. 
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
8.
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	I/0
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	LEF
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 what about X11?
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
That's a whole other subject. See: "X11/Motif portability concerns, Unix to OpenVMS"
at <a href="http://seqaxp.bio.caltech.edu/www/X11_VMS_NOTES.TXT">http://seqaxp.bio.caltech.edu/www/X11_VMS_NOTES.TXT</a>
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
9.
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	W/4
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	COM
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 data types
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
Ironically this will get you most often when you port from Tru64. "long 
int" there is 64 bits, but it's only 32 bits on OpenVMS. Tru64 also has
a long long type which is 128 bits. For "long int" you can usually 
#ifdef in "unsigned __int64" on the OpenVMS version. For "long long"
best hope that the code doesn't really need 128 bits, because you can't
get it on this platform!
<br>
<strong>
(OO) we know from the porting newsgroup and from direct contact that there will be
lots of 64 bit issues and typical compiler version specific workarounds in the code.
We'll try to produce clean code, but won't modify general code just for cleanlyness.
</strong>
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
10.
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	I/0
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	LEF
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 ioctl for terminals
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
If you encounter ioctl() calls being used to control a terminal you
are out of luck. The only solution is to rewrite the code using
QIO's. You will usually need to access the documentation from
the source Unix, as ioctl isn't all that portable among unix's either.
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
11.
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	E/16
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	CUR
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 makefile
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
OpenVMS has no "make". You can rewrite makefile to descrip.mms and
use either MMS (part of DECset) or MMK (free) and obtain similar 
functionality. Your other choice is to install GNV from
<a href="http://gnv.sourceforge.net/">http://gnv.sourceforge.net/</a>. It has bash and gmake. Use:
<pre>
$ @gnv:setup
$ bash
bash> make -n > make_vms.com
bash> exit
</pre>
Then use an editor (I prefer NEDIT for this work) to convert the
unix commands to their OpenVMS equivalents.
<br>
<strong>
(OO) We know we have to have DMAKE. This MAKE version is the achilles-heel of this port.
The whole project depends on the availability of DMAKE. We have a alpha version working.
Continued improvements in the CRTL and the porting library will make DMAKE a more stable
and reliable product.
</strong>
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
12.
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	I/0
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	LEF
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 lines are too long to view
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
Many of the OpenVMS tools don't like the wide records which are often
found in source code and other files originating on Unix systems. For instance,
you can't TYPE many files, and EDIT/EDT chokes on long records too.
I usually use NEDIT to handle these sorts of file problems.
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
13.
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	I/0
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	LEF
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 why does it run so slowly?
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
After you complete your port you will often find that the OpenVMS version
is much, much slower than the Unix version if it is very IO intensive.
The ratio can be as high as 100X faster for Unix over OpenVMS.
Most often this is due to the file caching speedup from Unix, plus the
2-6X slowdown that RMS imposes on record oriented files (as measured on a
RAMdisk.) Binary IO speeds will be closer, the IO slowdown is primarily 
a problem for text/record oriented files. You can improve performance by
using the SET RMS command to increase the block and buffer sizes. Also
increase tbe /extend value to avoid a flurry of short extends. If you
know ahead of time the final size of the output file set extend to that.
(You can also set these parameters in the code by using OpenVMS specific
extensions.) Improvements in the OpenVMS file caching system are in late
stages of development, an dthose should help once they appear on production
systems.
<br>
That said, watch out for the use of, umm, unusual file techniques on
programs from Unix. For instance, you may find frequent calls to
freopen(), or other program methods which cause the disk heads to
fly back and forth between the front of the file and the end. These 
sorts of bad design are masked on Unix by the file caching system,
but are exposed in all their glory on OpenVMS.
<br>
Programs may also run slowly on OpenVMS, or not at all, if they expect
to be able to grab vast amounts of memory. User accounts on OpenVMS are 
usually allocated a relatively small amount of virtual and physical
memory. 
<br>
<strong>
(OO) We hope to reach a stadium we can experience this problem ourselves ;-).
</strong>
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
14.
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	I/0
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	LEF
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 why do I get two (or more) copies of the output file?
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
Many Unix programs try to determine if they can write an output file
by doing an fopen, and if it succeeds, doing another. On Unix the
second one overwrites the first and no one's the wiser. On OpenVMS
you get two versions. Sometimes scratch files are used in a similar
manner, only for those they tend to be opened and closed many more
times, resulting in a long string of files.
<br>
<Strong>Fix</strong>: find the offending second fopen() and #ifdef it and the fclose()
before it out of the code. For scratch files, either reopen the
existing file or be sure to delete the file after the fclose().
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
15.
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	I/0
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	LEF
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 fseek/ftell don't work right
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
These assume a Unixlike file organization which may or may not be 
present on files being read by a C program in OpenVMS.
<br>
<Strong>Fix</strong>: rewrite the code to use fgetpos() and fsetpos().
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
16.
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	W/4
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	CUR
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 linker can't resolve ReadDir
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
By default Unix is case sensitive pretty much everywhere. OpenVMS is not.
So the symbol "ReadDir" goes to "readdir" which is the standard function.
You'll also see this a lot where people have a variable "foobar" and
a function "Foobar". It's generally a problem any place code uses case
to distinguish between variables and/or functions. (Constants, which 
only the compiler sees, tend not to cause so much havoc.) Code written
this way is really a pain to port because you (usually) didn't write it,
and so tend not to notice these minor case differences. The bugs which
can result if the linker does manage to resolve things, but incorrectly,
can be very messy.
<br>
<strong>Preferred fix</strong>: rewrite the code so that all symbols are unique when
uppercased.
<br>
<strong>Other fix</strong>: use the compiler switch /names=as_is, which preserves case. 
<br>
<strong>
(OO) We'll try to produce clean code, but won't modify general code just for cleanlyness.
</strong>
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
17.
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	I/0
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	LEF
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 compiler gives an implicit function warning for a common function
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
This happens either because the appropriate header has been omitted or
because the function in question is #ifdef'd off by language standard
specific defines. Most Unix compilers are really sloppy about which
function is in which language spec. Ok, they're not sloppy, but the 
programmers never put them into a mode where they check. So some 
function which is an XOPEN extension compiles in without warnings on
Unix but raises a warning on OpenVMS. 
<br>
<Strong>Fix</strong>: Use /define=(_XOPEN_SOURCE,_XOPEN_SOURCE_EXTENDED,_POSIX_SOURCE)
as required to get the right lines of the header files processed.
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
18.
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	W/2
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	COM
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 where are the standard header files?
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
They always live in the text library:
<br>
SYS$COMMON:[SYSLIB]DECC$RTLDEF.TLB
<br>
but may also have been expanded into 
<br>
SYS$SYSDEVICE:[SYS0.SYSCOMMON.DECC$LIB.REFERENCE.DECC$RTLDEF]*.h
<br>
<strong>
(OO) We installed two platforms (solaris and LINUX) just for refence.
</strong>
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
19.
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	E/4
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	COM
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 what's wrong with #include <../../foo/woo/blah.h>?
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
Putting paths into includes is BAD, EVIL, YUCKY, etc., and unfortunately,
fairly common. The example shown here is the worst case - you'll
only ever have a hope of compiling this if the default directory
is in exactly the right place.
<br>
<strong>Preferred fix</strong>: Whenever possible eliminate the paths from the code and 
use /include=([-],[],[.foo]) and the like to tell the compiler where to
find them. (These are the equivalent of using on Unix: -I.. -I. -Ifoo)
<br>
<strong>Desperate measures fix</strong>: For an include like </foo/woo/moo/blah.h>
you can define a concealed logical "foo" which points to the correct
place in the directory structure on your system and Compaq C will
be able to look in the [.woo.moo] subdirectory of it and find the
file blah.h. 
<br>
<strong>
(OO) We made a <a href="/openoffice/current/oovms.html">
oovms.com</a> file containing all discovered 'concealed logicals'
</strong>
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
20.
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	I/0
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	LEF
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 the compiler includes "foo.h" but not "Foo.h"
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
OpenVMS is case insensitive. Even ODS5, which will preserve case, will
not distinguish between these two files. Usually this shows up long 
before the compiler gets a shot at it when the archive is unpacked and 
complains/warns that it is overwriting FOO.H. 
<br>
<Strong>Fix</strong>: rewrite the code to use case invariant file names.
<br>
<strong>
(OO) We'll try to produce clean code, but won't modify general code just for cleanlyness.
</strong>
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
21.
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	I/0
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	LEF
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 how do I find a memory access problem?
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
Often code which ran "correctly" on one platform will fail miserably on 
another if it access memory out of bounds. Such "working" code will
usually fail when you port it to OpenVMS just because variables will
be located in memory differently.
<br>
One method of dealing with this is to do:
<pre>
#ifdef __VMS
#define free myfree
int decc$free(void *ptr); /* prototype for decc$free */
void myfree( void *ptr){
#include <lib$routines.h>
#include <ssdef.h>
if(decc$free(ptr) != 0){
(void) printf("illegal free() operation\n");
(void) lib$signal(SS$_ACCVIO);
}
}
#endif /* __VMS */
</pre>
decc$free will complain if you try to free a region of memory, whereas 
free() cannot warn you about the mayhem which is being committed. Many 
memory errors begin or end with an invalid free() and this will catch 
them.
<br>
Here is a method suggested by Hoff (Stephen) Hoffman and posted in comp.os.vms
<br>
Because of the likelyhood of application programming errors -- trampling past the
end of the allocated storage being most common -- I almost never call malloc and
free directly. Further, by intercepting the memory allocation calls, I can call
lib$get_vm and similar, particularly using VM zones, and can tailor the particular
behaviour most appropriate. With a "temporary mempory pool" VM zone, I can also
flush all allocations in that zone in a single call, so that I can easily reset the pool... 
Also available with VM zones are the tools to traverse and report on the VM zones.
<br>
Jacket your calls to malloc and free. Code the malloc jacket to add a quadword at
the front of the allocated area and a quadword at the back and then call the actual
malloc asking for the requested size plus sixteen bytes. Before returning the
allocated storage -- the base address of the allocated block plus eight -- fill the
front and back quadword with a known (and no zero bytes in the quadword)
pattern, possibly based on the address and size, etc. Code the free jacket to check
for the patterns and scream if it finds errors, and to call free if not -- remembering
to back up the base of the buffer by eight bytes from what the caller passed in. (I
typically refer to these quadwords as "fenceposts" -- straying from the expected
behaviour is quite easy to track down.)
<br>
If you were on more recent OpenVMS Alpha version, you could use the heap
analyzer in the OpenVMS Debugger to poke around.
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
22.
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	E/24
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	CEF
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 fork()
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
OpenVMS vfork() doesn't work like fork(). Search your code for 
fork() and if you find it, refer to gnuplot, or some other already
ported application, for an example of how to replace the code.
<br>
<strong>
(OO) We know we have to have DMAKE. This MAKE version is the achilles-heel of this port.
The whole project depends on the availability of DMAKE. We have a alpha version
(non-distributed version) working. The distibuted version depends on the fork()
function. 
Continued improvements in the CRTL and the porting library will make DMAKE a more stable
and reliable product.
</strong>
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
23.
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	I/0
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	LEF
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 where do I look for help?
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
Post to the newsgroup comp.os.vms
<br>
Use dejanews power search at
<br>
<a href="http://www.dejanews.com/home_ps.shtml">http://www.dejanews.com/home_ps.shtml</a>
<br>
to search that newsgroup. (Be aware that the default
setting only goes back about a year, use the date fields
on the bottom to look back further.)
<br>
"Ask the wizard" at
<br>
<a href="http://h71000.www7.hp.com/wizard/">http://h71000.www7.hp.com/wizard/</a>
<br>
Get a copy of the freeware CD or other already ported programs and
scan them for solutions to the current problem. The freeware CD
is on the net at:
<br>
<a href="http://h71000.www7.hp.com/openvms/freeware/freeware.html">http://h71000.www7.hp.com/openvms/freeware/freeware.html</a>
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
24.
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	I/0
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	LEF
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 system()
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
system() passes a command line to a subprocess, executes it, and then 
returns. Since the command line is by definition OS specific, any 
instances of system() in ported code must inevitably be rewritten. Ideally
they should be removed entirely - find some way to do perform the desired 
action in code rather than by running a subprocess.
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
25(JEM).
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	I/0
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	LEF
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 getenv() behavior
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
The behavior of getenv() depends on the version and ECO of the DEC C RTL 
and possibly logical names defined on your system. 
<br>
<Strong>Fix</strong>: use sys$trnlnm() instead.
<br>
(DRM comment: I've also observed instances where symbols and logicals
interfered with the expected behavior. This happened primarily when the
symbol/logical involved was a "standard" symbol that getenv handled 
differently. For instance, if "term" was previously defined in DCL than
getenv("term") would return the user defined value, which often was not
at all the desired quantity, and the program would fail.)
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
26(JEM).
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	I/0
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	LEF
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 mmap() on text files
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
mmap() will open files in a binary mode. That is fine so long as the file
is stream-lf or binary. However, if it is some other type of RMS file the
program doing this will likely fail when it encounters the embedded RMS
information.
<br>
<Strong>Fix</strong> (DRM): require input files to be either stream-lf or binary, or if 
that is not possible, do not use mmap(). Either way will likely require 
extensive recoding.
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
27(JEM).
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	I/0
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	LEF
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 /tmp and others map to locations, overridden by logical names
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
Apparently some versions of the C RTL map /tmp to SYS$SCRATCH /dev/null to
NLA0:, and perhaps some others are translated as well. In the case of /tmp
if you have defined a logical TMP and try to write to /tmp/foo.txt it will
go to the directory set by the logical. This is consistent with the usage
of logicals for paths which are not "special". Just be aware that the
logical TMP or DEV may have been defined with some other meaning, so that
/dev/null might end up creating a real file NULL in the directory pointed
to by the logical DEV! 
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
28(JEM).
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	I/0
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	LEF
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 setuid()
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
The setuid() function is a stub and just returns 0 to indicate "success".
That may not be optimal, since it really failed (the UID did not change.)
User written setuid() is possible, but when the transfer is to an account
which does not have read access to the calling processes job table, then
SYS$SCRATCH and SYS$LOGIN will not be available. 
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
29(JEM).
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	I/0
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	LEF
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 uid_t/gid_t size inconsistencies
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
getuid() returns 16 bits (the member part of a UIC) with some compiler
flags or on VMS 6.x and under, and 32 bits (the whole UIC) otherwise.
stat() returns a 32 bit uid and a 16 bit gid.
setuid() (user written) will need a 32 bit uid value.
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
30.
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	I/0
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	LEF
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 Files produced by the C RTL have invalid RMS attributes
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
This isn't a portability problem per se, but rather a general
C RTL problem which will affects all ported programs. The problem is that
sequential text files written by the C RTL default to having a Longest
Record value of 32767, and this can cause havoc with some other programs
which foolishly believe that the value is accurate. For instance, SORT
will allocate 32767 bytes/record for any such file, so that it cannot
easily sort even a relatively small file. ( The work around in this instance
is to either use SORT/PROCESS=tag or to figure out how big LRL is
and repair the file with SET FILE/ATTRIB=(lrl:whatever) before sorting it.) 
<br>
<strong>Partial fix</strong>: (This is really a sad excuse for a solution but it's all 
there is) 
<pre>
$ define/user decc$default_lrl 100
</pre>
will set the LRL value to 100 instead of 32767. However, the 100 can be
just as wrong as the 32767 - write a record of length 16k into that file
and the RMS value will stay at 100. The C RTL should really just keep
track of the records it writes and put the REAL value.
<br>
Section 1.6 of the Compaq C Run-Time Library Reference Manual is the
only place this logical is mentioned:
<pre>
In OpenVMS Version 7.0 the default LRL value on
stream files was changed from 0 to 32767. This
change caused significant performance degradation
on certain file operations such as sort.
<br>
<br>
This is no longer a problem. The Compaq C
Run-Time Library now lets you define the logi-
cal DECC$DEFAULT_LRL to change the default
record-length value on stream files.
<br>
The Compaq C Run-Time Library first looks for this
logical. If it is found and it translates to a numeric
value between 0 and 32767, that value is used for the
default LRL.
</pre>
I disagree emphatically that "this is no longer a problem". The value of 
LRL set by DECC$DEFAULT_LRL is every bit as wrong as the default LRL. Its
only advantage is that it can be "small and wrong" rather than "large and 
wrong."
		</div>
	  </td>
        </tr>
        <tr>
	<td bgcolor="#f0f0f0">
		<div align="left">
31.
		</div>
	</td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	I/0
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
	LEF
		</div>
	  </td>
        <td bgcolor="#f0f0f0">
		<div align="left">
 Where do I obtain tools and libraries for porting?
		</div>
	  </td>
          <td bgcolor="#f0f0f0">
		<div align="left">
bash,gmake, and many others are part of GNV <a href="http://gnv.sourceforge.net/">http://gnv.sourceforge.net/</a><br>
qt 2.1 http://www.saalhausen.de/lehrig/qt21_bck.zip<br>
xforms 0.88 (warning, bugs in some versions of the C RTL and some graphics drivers are triggered by this software! Includes a port
of XPM in shareable format) <a href="http://world.std.com/~xforms/">http://world.std.com/~xforms/</a><br>
parallel programming: pvm, tcgmsg (maybe MPICH too, but it wasn't there as this was written) <a href="ftp://v36.chemie.uni-konstanz.de/">
ftp://v36.chemie.uni-konstanz.de/</a><br>
OpenVMS Porting Library from Compaq (released 22-JUN-2000)
<a href="http://www.openvms.digital.com/openvms/products/ips/porting.html">http://www.openvms.digital.com/openvms/products/ips/porting.html</a><br>
Many libraries may be found in already completed ports see:<br>
<a href="http://www.openvms.digital.com/openvms/freeware/index.html">http://www.openvms.digital.com/openvms/freeware/index.html</a><br>
<a href="http://www.openvms.digital.com/openvms/freeware/freeware.html">http://www.openvms.digital.com/openvms/freeware/freeware.html</a><br>
Use advanced search from <a href="http://www.dejanews.com">http://www.dejanews.com</a> to look for posts in
<a href="http://groups.google.com/groups?hl=en&lr=&ie=UTF-8&oe=UTF-8&group=comp.os.vms">comp.os.vms</a> concerning the package of interest.
		</div>
	  </td>
        </tr>
      </table>

      <br>
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
              <tr>
                      <td>
                              <div align="left">
                                      Maintained by the 
                                      <a href="mailto:oooodoc@oooovms.dyndns.org">
                                              OpenOffice on OpenVMS porting Project</a>. 
                              </div>
                      </td>
              </tr>
      </table>

</div>
</td>

</tr>
</table>
 
 
 <div id="footer"><table border="0" cellspacing="0" cellpadding="4"><tr><td>
<p>We welcome your <a href="http://porting.openoffice.org/project/www/contact.html">feedback</a>.</p>
<p>By any use of this Website, you agree to be bound by these <a href="http://www.sunsource.net/TUPPCP.html">Policies and Terms of Use</a></p>
<p>CollabNet, Inc. CollabNet is a trademark of CollabNet, Inc.
Sun, Sun Microsystems, the Sun Logo, Solaris, Java, StarOffice, StarOffice 7 and StarSuite 7 are trademarks or registered trademarks of Sun Microsystems, Inc., in the United States and other countries.</p>
</td>
<td nowrap="nowrap">
<p class="center><a href="http://www.collab.net/special/clickpbc0502.html" target="collab"><img src="http://porting.openoffice.org/branding/images/poweredby_036.gif" alt="This site is Powered by CollabNet." id="poweredby" width="102" height="38" border="0" /></a></p>
</td>
</tr></table></div>
 
 
</body>
</html>
